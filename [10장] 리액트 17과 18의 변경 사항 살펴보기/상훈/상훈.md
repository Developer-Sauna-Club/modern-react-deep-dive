## ë¦¬ì•¡íŠ¸ 17 ë²„ì „ ë³€ê²½ì 

### ì ì§„ì  ì—…ê·¸ë ˆì´ë“œ

- ì´ì „ì—ëŠ” ë¦¬ì•¡íŠ¸ì˜ ë²„ì „ì„ ì˜¬ë¦¬ê¸° ìœ„í•´ì„œëŠ” ë°˜ë“œì‹œ ì „ì²´ í”„ë¡œì íŠ¸ì— ì ìš©ë˜ì–´ ìˆëŠ” ë¦¬ì•¡íŠ¸ì˜ ë²„ì „ì„ í•œêº¼ë²ˆì— ë³€ê²½í•˜ëŠ” ë°©ë²•ë°–ì— ì—†ì—ˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ°ë° ì´ì œ 17 ë²„ì „ë¶€í„°ëŠ” ì¼ë¶€ ì˜ì—­ì—ë§Œ 16 ë²„ì „ì„ ì ìš©í•˜ê³ , ë‹¤ë¥¸ ì˜ì—­ì—ëŠ” 17 ë²„ì „ì„ ì ìš©í•˜ëŠ” ë“± ì ì§„ì ì¸ ì—…ê·¸ë ˆì´ë“œê°€ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.
- ë‹¤ë§Œ, ì´ëŠ” ì–´ë””ê¹Œì§€ë‚˜ í•œêº¼ë²ˆì— ì—…ê·¸ë ˆì´ë“œê°€ ë¶ˆê°€ëŠ¥í•œ ìƒí™©ì„ ìœ„í•œ ê¸°ëŠ¥ì´ê³ , ì¼ë°˜ì ìœ¼ë¡œëŠ” ê´€ë¦¬ ì§€ì ì´ ëŠ˜ì–´ë‚˜ê²Œ ë˜ëŠ” ë¬¸ì œê°€ ìˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•˜ë‹¤ë©´ ì „ì²´ ë²„ì „ì„ ì—…ê·¸ë ˆì´ë“œ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

### ë³€ê²½ëœ JSX transform

- ì´ì „ì—ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ë‚´ì—ì„œ `React` ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šë”ë¼ë„ ë°˜ë“œì‹œ import êµ¬ë¬¸ì´ í•„ìš”í–ˆì—ˆìŠµë‹ˆë‹¤.
- ì´ëŠ” ê¸°ì¡´ì— JSX êµ¬ë¬¸ì„ JSë¡œ íŠ¸ëœìŠ¤íŒŒì¼ë§í•˜ëŠ” ê³¼ì •ì—ì„œ JSX êµ¬ë¬¸ì´ `React.createElement` ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¡œ ë³€ê²½ë˜ê¸° ë•Œë¬¸ì´ì—ˆëŠ”ë°, ì´ì   `react/jsx-runtime` ì„ í™œìš©í•˜ëŠ” í˜•íƒœë¡œ ë³€ê²½ë˜ì—ˆê³  `import` êµ¬ë¬¸ë„ ìë™ìœ¼ë¡œ ì£¼ì…í•´ì£¼ê¸° ë•Œë¬¸ì— ë” ì´ìƒ ê°œë°œìê°€ ì§ì ‘ `import` í•˜ì§€ ì•Šì•„ë„ ë˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
- ì°¸ê³ ë¡œ, ë¦¬ì•¡íŠ¸ 19 ë²„ì „ë¶€í„°ëŠ” `React.createElement` ë¡œ ë³€í™˜ë˜ëŠ” ë°©ì‹ì´ ì™„ì „íˆ deprecated ë  ì˜ˆì •ì…ë‹ˆë‹¤.

### ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹ ë³€ê²½

![https://legacy.reactjs.org/blog/2020/08/10/react-v17-rc.html](react-event.png)

- ì´ì „ì—ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì— ë“±ë¡ëœ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ DOM ìµœìƒìœ„ ìš”ì†Œì— ìœ„ì„ë˜ì—ˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ°ë°, ë¦¬ì•¡íŠ¸ 17 ë²„ì „ë¶€í„°ëŠ” ë£¨íŠ¸ ìš”ì†Œì— ìœ„ì„í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

<aside>
ğŸ’¡ **ì™œ ì´ë ‡ê²Œ ë°”ë€Œì—ˆë‚˜ìš”?**
1. ì ì§„ì ì¸ ì—…ê·¸ë ˆì´ë“œê°€ ì ìš©ë˜ì–´ì„œ í•œ í”„ë¡œì íŠ¸ ì•ˆì—ì„œ ë¦¬ì•¡íŠ¸ ë²„ì „ì´ ì—¬ëŸ¬ ê°œê°€ ë  ìˆ˜ ìˆê³ , ì´ëŠ” ì¦‰ ë£¨íŠ¸ ë…¸ë“œê°€ ì—¬ëŸ¿ì´ ë  ìˆ˜ ìˆë‹¤ëŠ” ì´ì•¼ê¸°ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ DOM ìµœìƒìœ„ ìš”ì†ŒëŠ” ë‹¨ í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì—, **ì—¬ëŸ¬ ê°œì˜ ë¦¬ì•¡íŠ¸ ë²„ì „ì—ì„œ í•˜ë‚˜ì˜ DOM ìš”ì†Œì— ì´ë²¤íŠ¸ë¥¼ ìœ„ì„í•˜ì—¬ ë“±ë¡í•˜ëŠ” ê²ƒì€ ì ì¬ì ì¸ ë²„ê·¸ë¥¼ ìœ ë°œí•  ê°€ëŠ¥ì„±**ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

2. ë§Œì•½ document.addEventListener(...) ë¥¼ ì‚¬ìš©í•´ì„œ ìˆ˜ë™ DOM ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í–ˆë‹¤ê³  í•  ë•Œ, 16 ì´ì „ ë²„ì „ì—ì„œëŠ” **ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì˜ í•¸ë“¤ëŸ¬ì—ì„œ e.stopPropagation() ì„ í˜¸ì¶œí•˜ë”ë¼ë„ ë¬´ì¡°ê±´ ìˆ˜ë™ DOM ë¦¬ìŠ¤ë„ˆê°€ ë™ì‘**í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ 17 ë²„ì „ë¶€í„°ëŠ” ì´ëŸ° ì¼ì€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰, React ì—ì„œì˜ ì´ë²¤íŠ¸ ì „íŒŒê°€ ì¼ë°˜ DOMê³¼ ë”ìš± ìœ ì‚¬í•œ ì˜ˆì¸¡ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

</aside>

### ì´ë²¤íŠ¸ í’€ë§ ì œê±°

- ë¦¬ì•¡íŠ¸ 16 ì´ì „ ë²„ì „ì—ì„œëŠ” ì´ë²¤íŠ¸ë¥¼ í•¸ë“¤ë§í•˜ëŠ” ë° í•©ì„± ì´ë²¤íŠ¸(SyntheticEvent)ë¼ëŠ” ë˜í¼ë¥¼ êµ¬ì„±í•´ì„œ ì‚¬ìš©í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
- ì´ëŠ”, ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ë¯¸ë¦¬ í’€ì— ë“±ë¡í•´ ë†“ê³  ì‹¤ì œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ í’€ì—ì„œ êº¼ë‚´ì™€ì„œ ì‚¬ìš©í•œ ë’¤ì— ë‹¤ì‹œ nullë¡œ ì´ˆê¸°í™”í•˜ì—¬ í’€ì— ë„£ì–´ ë†“ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒ ì´ì—ˆëŠ”ë° ì‚¬ì‹¤ìƒ ìµœì‹  ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì´ëŸ¬í•œ í’€ë§ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ì„±ëŠ¥ì ì¸ ì´ì ì€ ì—†ê³ , ê°œë°œìì—ê²Œ í˜¼ë€ë§Œ ì¤€ë‹¤ê³  íŒë‹¨ë˜ì–´ 17 ë²„ì „ì—ì„œëŠ” ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.
- ë¦¬ì•¡íŠ¸ 16 ì´ì „ì—ì„œì˜ ë™ì‘ ë°©ì‹
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ë¶€ì— ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ëŠ” ë¡œì§ì´ ìˆëŠ” ê²½ìš°, ì´ë²¤íŠ¸ ê°ì²´ëŠ” ì´ë¯¸ event poolë¡œ ë“¤ì–´ê°€ì„œ nullë¡œ ì´ˆê¸°í™”ëœ ìƒí™©ì´ê¸°ì— ì°¸ì¡°í•  ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆì—ˆìŠµë‹ˆë‹¤.
  ```jsx
  function handleChange(e) {
    setData((data) => ({
      ...data,
      // This crashes in React 16 and earlier:
      text: e.target.value,
    }));
  }
  ```
  - ê·¸ë˜ì„œ ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ `e.persist()` ë¥¼ ì‚¬ìš©í•´ì•¼ í–ˆì—ˆëŠ”ë°, ì§ê´€ì ì´ì§€ ì•Šê³  í˜¼ë€ìŠ¤ëŸ¬ìš´ ë™ì‘ì´ì—ˆìŠµë‹ˆë‹¤.
  ```jsx
  function handleChange(e) {
    e.persist();
    setData((data) => ({
      ...data,
      // This crashes in React 16 and earlier:
      text: e.target.value,
    }));
  }
  ```

### useEffect í´ë¦°ì—… í•¨ìˆ˜ì˜ ë¹„ë™ê¸° ì‹¤í–‰

- ë¦¬ì•¡íŠ¸ 16 ì´ì „ ë²„ì „ì—ì„œëŠ”, `useEffect` ì˜ í´ë¦°ì—… í•¨ìˆ˜ê°€ ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰, Render Phaseì—ì„œ ë‹¤ìŒ ìŠ¤ëƒ…ìƒ·ì˜ ë Œë”ë§ì„ ì²˜ë¦¬í•˜ê¸° ì´ì „ì— `useEffect`ì˜ í´ë¦°ì—… í•¨ìˆ˜ë¥¼ ë¨¼ì € ì²˜ë¦¬í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.
- ë§Œì•½ í´ë¦°ì—… í•¨ìˆ˜ì˜ ì²˜ë¦¬ ì‹œê°„ì´ ê¸¸ì–´ì§„ë‹¤ë©´, ë‹¤ë¥¸ ì‘ì—…ì„ Blockingí•˜ëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆì—ˆëŠ”ë° ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `useEffect` ì˜ í´ë¦°ì—… í•¨ìˆ˜ê°€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ë„ë¡ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. ì¦‰, ë¦¬ë Œë”ë§ ê³¼ì •ì—ì„œ ë‹¤ìŒ ìŠ¤ëƒ…ìƒ·ì˜ Commit ë‹¨ê³„ë¥¼ ë§ˆì¹œ ì´í›„ì—, ì´ì „ ìŠ¤ëƒ…ìƒ·ì˜ í´ë¦°ì—… í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
- ê¸°ì¡´: Cleanup â†’ Rerender â†’ New Effect
- í˜„ì¬: Rerender â†’ Cleanup â†’ New Effect

## ë¦¬ì•¡íŠ¸ 18 ë²„ì „ ë³€ê²½ì 

### Auto Batching

- ë¦¬ì•¡íŠ¸ì—ì„œ ë™ì¼í•œ íƒ€ì´ë°ì— í˜¸ì¶œí•œ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” í•˜ë‚˜ì˜ ì—…ë°ì´íŠ¸ë¡œ ë¬¶ì–´ì„œ ë°°ì¹­ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ê·¸ëŸ°ë° 17 ì´ì „ ë²„ì „ì—ì„œëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œëŠ” ë°°ì¹­ ì²˜ë¦¬ê°€ ë˜ì—ˆì§€ë§Œ, `setTimeout` ì´ë‚˜ `Promise` ì™€ ê°™ì€ ë¹„ë™ê¸° ì´ë²¤íŠ¸ì— ëŒ€í•´ì„œëŠ” ë°°ì¹­ ì²˜ë¦¬ê°€ ë˜ì§€ ì•Šê³  ìˆì–´ì„œ ì¼ê´€ì„±ì´ ì—†ì—ˆìŠµë‹ˆë‹¤.
- ì´ì œ 18 ë²„ì „ì—ì„œëŠ” ëª¨ë‘ ì¼ê´„ì ìœ¼ë¡œ ë°°ì¹­ ì²˜ë¦¬ê°€ ë©ë‹ˆë‹¤. (createRootë¡œ ë£¨íŠ¸ ë…¸ë“œë¥¼ ìƒì„±í•œ ê²½ìš°)
- ë§Œì•½, ë°°ì¹­ì²˜ë¦¬ í•˜ê³ ì‹¶ì§€ ì•Šì€ ìƒíƒœ ì—…ë°ì´íŠ¸ê°€ ìˆë‹¤ë©´ `flushSync` ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

### Suspense

- SuspenseëŠ” ë¦¬ì•¡íŠ¸ 16.6 ë²„ì „ì—ì„œ ë„ì…ëœ ê¸°ëŠ¥ìœ¼ë¡œ, ì»´í¬ë„ŒíŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ì„œ ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ì— ìì£¼ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥ì´ì—ˆìŠµë‹ˆë‹¤.
- ì´ì œëŠ” Promiseë¥¼ throwí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¹„ë™ê¸° ì»´í¬ë„ŒíŠ¸ê°€ ì¤€ë¹„ë˜ëŠ” ë™ì•ˆ fallback UIë¥¼ ë³´ì—¬ì£¼ê³  ì‹¶ì„ ë•Œì—ë„ í™œìš©í•  ìˆ˜ ìˆë„ë¡ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.
- Suspenseì˜ ê¸°ëŠ¥ì´ í™•ì¥ë¨ì— ë”°ë¼, ì„œë²„ì—ì„œ ì¤€ë¹„ê°€ ì™„ë£Œëœ ì»´í¬ë„ŒíŠ¸ë¶€í„° ì ì§„ì ìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” Steaming SSRì™€, ì „ì²´ í˜ì´ì§€ë¥¼ í•œë²ˆì— í•˜ì´ë“œë ˆì´ì…˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë¶€ë¶„ì ìœ¼ë¡œ í•˜ì´ë“œë ˆì´ì…˜ì„ ë¨¼ì € ìˆ˜í–‰í•˜ëŠ” Selective Hydration ê°€ ë„ì…ë˜ì—ˆìŠµë‹ˆë‹¤.

### useId

```jsx
const id = useId();
```

- ê³ ìœ í•œ IDë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” í›…ì…ë‹ˆë‹¤. (UUIDì™€ ë¹„ìŠ·í•œ ê¸°ëŠ¥)
- SSR í™˜ê²½ì—ì„œ ìƒì„±í•œ IDì™€, Client-Sideì—ì„œ Hydrationí•˜ëŠ” ê³¼ì •ì—ì„œ ìƒì„±ëœ IDê°€ ì¼ì¹˜í•¨ì„ ë³´ì¥í•©ë‹ˆë‹¤. (Hydration Mismatch ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šê²Œ ë„ì™€ì¤Œ)
- êµ¬í˜„ë¶€

  ```
  function mountId(): string {
    const hook = mountWorkInProgressHook();

    const root = ((getWorkInProgressRoot(): any): FiberRoot);
    // TODO: In Fizz, id generation is specific to each server config. Maybe we
    // should do this in Fiber, too? Deferring this decision for now because
    // there's no other place to store the prefix except for an internal field on
    // the public createRoot object, which the fiber tree does not currently have
    // a reference to.
    const identifierPrefix = root.identifierPrefix;

    let id;
    if (getIsHydrating()) {
      const treeId = getTreeId();

      // Use a captial R prefix for server-generated ids.
      id = ':' + identifierPrefix + 'R' + treeId;

      // Unless this is the first id at this level, append a number at the end
      // that represents the position of this useId hook among all the useId
      // hooks for this fiber.
      const localId = localIdCounter++;
      if (localId > 0) {
        id += 'H' + localId.toString(32);
      }

      id += ':';
    } else {
      // Use a lowercase r prefix for client-generated ids.
      const globalClientId = globalClientIdCounter++;
      id = ':' + identifierPrefix + 'r' + globalClientId.toString(32) + ':';
    }

    hook.memoizedState = id;
    return id;
  }

  function updateId(): string {
    const hook = updateWorkInProgressHook();
    const id: string = hook.memoizedState;
    return id;
  }
  ```

### useTransition

```jsx
const [isPending, startTransition] = useTransition();
```

- startTransitionì˜ ì½œë°± ë‚´ë¶€ì— ì‘ì„±í•˜ëŠ” ìƒíƒœ ì—…ë°ì´íŠ¸ì˜ ìš°ì„  ìˆœìœ„ë¥¼ TransitionLaneìœ¼ë¡œ ë³´ë‚´ë²„ë ¤ì„œ ë” ë¹¨ë¦¬ ë Œë”ë§í•´ì•¼ í•˜ëŠ” ì‘ì—…ì„ ë¨¼ì € ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” í›…ì…ë‹ˆë‹¤.
- í•´ë‹¹ ì‘ì—…ë³´ë‹¤ ìš°ì„  ìˆœìœ„ê°€ ë” ë†’ì€ ì‘ì—…ì´ ì¡´ì¬í•¨ìœ¼ë¡œ ë Œë”ë§ì´ ì§€ì—°ë˜ê³  ìˆìŒì„ `isPending` ìƒíƒœ ë³€ìˆ˜ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.
- `useTransition` í›… ë‚´ë¶€ì—ì„œëŠ” `startTransition` ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹Œ ê³³ì— ìš°ì„ ìˆœìœ„ë¥¼ ë‚´ë¦¬ëŠ” ì—…ë°ì´íŠ¸ ì‘ì—…ì„ ì§ì ‘ `startTransition` ë¥¼ importí•´ë„ ë©ë‹ˆë‹¤.

```jsx
import { startTransition } from 'react';
```

- êµ¬í˜„ë¶€

  ```jsx
  function mountTransition(): [
    boolean,
    (callback: () => void, options?: StartTransitionOptions) => void
  ] {
    const [isPending, setPending] = mountState(false);
    // The `start` method never changes.
    const start = startTransition.bind(null, setPending);
    const hook = mountWorkInProgressHook();
    hook.memoizedState = start;
    return [isPending, start];
  }

  function updateTransition(): [
    boolean,
    (callback: () => void, options?: StartTransitionOptions) => void
  ] {
    const [isPending] = updateState(false);
    const hook = updateWorkInProgressHook();
    const start = hook.memoizedState;
    return [isPending, start];
  }
  ```

### useDefferedValue

```jsx
const deferredValue = useDeferredValue(value);
```

- `useTransition` ê°€ ìƒíƒœ ì—…ë°ì´íŠ¸ ë™ì‘ ìì²´ì˜ ìš°ì„  ìˆœìœ„ë¥¼ ë‚®ì·„ë‹¤ë©´, `useDefferedValue` ëŠ” ê°’ ìì²´ê°€ ë³€ê²½ë˜ëŠ” ì‹œì ì˜ ìš°ì„  ìˆœìœ„ë¥¼ ë‚®ì¶¥ë‹ˆë‹¤.
- ë””ë°”ìš´ì‹±ì´ë‚˜ ì“°ë¡œí‹€ë§ìœ¼ë¡œë„ ê°’ì˜ ì—°ì‚°ì„ ìµœì í™”í•  ìˆ˜ ìˆê¸´ í•˜ì§€ë§Œ, ì´ ê²½ìš°ì—ëŠ” ì´ë¯¸ Call Stackì— ì‘ì—…ì´ ë“¤ì–´ì˜¨ ì´í›„ì—ëŠ” ë” ë†’ì€ ìš°ì„ ìˆœìœ„ì˜ ì‘ì—…ì´ ë“¤ì–´ì™€ë„ ì¤‘ë‹¨í•  ìˆ˜ ì—†ë‹¤ëŠ” ë¬¸ì œì ì´ ìˆê³ , ìµœì†Œ ë‹¨ìœ„ ì‹œê°„ì´ í•„ìš”í•˜ë‹¤ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. (useDefferedValueëŠ” ë‹¨ìœ„ ì‹œê°„ì´ í•„ìš”í•˜ì§€ëŠ” ì•Šê³  ì‘ì—…ì´ ê°€ëŠ¥í•œ ìˆœê°„ì´ ë˜ë©´ ë°”ë¡œ ì²˜ë¦¬)
- êµ¬í˜„ë¶€

  - `updateDeferredValueImpl` ë¥¼ ì‚´í´ë³´ë©´
    1. **ì—…ë°ì´íŠ¸ë¥¼ ì§€ì—°í•´ì•¼ í•˜ëŠ” ê²½ìš°**
       claimNextTransitionLane ë¥¼ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ ì°¨ì„ (Lane)ë§Œ í• ë‹¹ ë°›ì•„ ë†“ì€ ë‹¤ìŒì— ì´ì „ ê°’(prevValue) ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
    2. **ì§€ê¸ˆ ì—…ë°ì´íŠ¸ í•´ë„ ë˜ëŠ” ê²½ìš°**
       hook.memoizedState ê°’ì„ ë³€ê²½í•©ë‹ˆë‹¤.

  ```jsx
  function mountDeferredValue<T>(value: T): T {
    const hook = mountWorkInProgressHook();
    hook.memoizedState = value;
    return value;
  }

  function updateDeferredValue<T>(value: T): T {
    const hook = updateWorkInProgressHook();
    const resolvedCurrentHook: Hook = (currentHook: any);
    const prevValue: T = resolvedCurrentHook.memoizedState;
    return updateDeferredValueImpl(hook, prevValue, value);
  }

  function updateDeferredValueImpl<T>(hook: Hook, prevValue: T, value: T): T {
    const shouldDeferValue = !includesOnlyNonUrgentLanes(renderLanes);
    if (shouldDeferValue) {
      // This is an urgent update. If the value has changed, keep using the
      // previous value and spawn a deferred render to update it later.

      if (!is(value, prevValue)) {
        // Schedule a deferred render
        const deferredLane = claimNextTransitionLane();
        currentlyRenderingFiber.lanes = mergeLanes(
          currentlyRenderingFiber.lanes,
          deferredLane
        );
        markSkippedUpdateLanes(deferredLane);

        // Set this to true to indicate that the rendered value is inconsistent
        // from the latest value. The name "baseState" doesn't really match how we
        // use it because we're reusing a state hook field instead of creating a
        // new one.
        hook.baseState = true;
      }

      // Reuse the previous value
      return prevValue;
    } else {
      // This is not an urgent update, so we can use the latest value regardless
      // of what it is. No need to defer it.

      // However, if we're currently inside a spawned render, then we need to mark
      // this as an update to prevent the fiber from bailing out.
      //
      // `baseState` is true when the current value is different from the rendered
      // value. The name doesn't really match how we use it because we're reusing
      // a state hook field instead of creating a new one.
      if (hook.baseState) {
        // Flip this back to false.
        hook.baseState = false;
        markWorkInProgressReceivedUpdate();
      }

      hook.memoizedState = value;
      return value;
    }
  }
  ```

### useSyncExternalStore

```jsx
const snapshot = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot?)
```

- React 18ì—ì„œ ë„ì…ëœ ë™ì‹œì„± ë Œë”ë§ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì™¸ë¶€ ë°ì´í„°ë¥¼ êµ¬ë…í–ˆì„ ë•Œ ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ í™”ë©´ì—ì„œ ê·¸ë ¤ì§€ëŠ” ê°’ì´ ë‹¬ë¼ì§€ëŠ” Tearing í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ë˜ì„œ ì™¸ë¶€ ìŠ¤í† ì–´ë¥¼ ë™ê¸°ì ìœ¼ë¡œ êµ¬í˜„í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” í›…ì…ë‹ˆë‹¤.

### useInsertionEffect

- CSS-in-JS ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°œë°œìë“¤ì´ DOM ìš”ì†Œì— ìŠ¤íƒ€ì¼ì„ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ëŠ” í›…ì…ë‹ˆë‹¤.
- DOMì´ ì‹¤ì œë¡œ ë³€ê²½ë˜ê¸° ì „ì— ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- useInsertionEffect(DOM ë°˜ì˜ ì´ì „) â†’ useLayoutEffect(DOM ë°˜ì˜ ì´í›„) â†’ useEffect ìˆœì„œë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

## References

[https://puki4416blog.netlify.app/how-to-react-event-handle/#syntheticevent-ê°ì²´](https://puki4416blog.netlify.app/how-to-react-event-handle/#syntheticevent-%EA%B0%9D%EC%B2%B4)

[https://medium.com/crossplatformkorea/react-ë¦¬ì•¡íŠ¸ë¥¼-ì²˜ìŒë¶€í„°-ë°°ì›Œë³´ì-06-í•©ì„±-ì´ë²¤íŠ¸ì™€-event-pooling-6b4a0801c9b9](https://medium.com/crossplatformkorea/react-%EB%A6%AC%EC%95%A1%ED%8A%B8%EB%A5%BC-%EC%B2%98%EC%9D%8C%EB%B6%80%ED%84%B0-%EB%B0%B0%EC%9B%8C%EB%B3%B4%EC%9E%90-06-%ED%95%A9%EC%84%B1-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%99%80-event-pooling-6b4a0801c9b9)

https://ko.legacy.reactjs.org/blog/2020/08/10/react-v17-rc.html#no-event-pooling

https://blog.mathpresso.com/suspense-ssr-architecture-in-react-18-ec75e80eb68d
